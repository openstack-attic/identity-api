OpenStack Identity API v3 OS-FED-IDP Extension
==============================================

Provide the ability for users to manage identity providers. This
extension requires v3.0+ of the Identity API.

Definitions
-----------

- *Trusted Identity Provider:* An identity provider setup within the
  Identity Service that is trusted to provide authenticated user information
  for token generation.

API Resources
-------------

### Identity Providers: `/OS-FED-IDP/identity-providers`

An `identity provider` is a third party service that is trusted by the
Identity Service to authenticate identities. For OpenStack, the ID of
the identity provider is the key. Each IDP the protocol_data field
can be used to add IDP specific metadata that is needed to talk to
this IDP.

Optional attributes:

- `description` (string)
- `supported_protocols` (list)
- `protocol_data` : (list)
- `mapping_id`: (string)

Immutable attributes:

- `name` (string)
- `active` (boolean)
- `domain_id` (string)


Identity Provider API
---------------------

### Create an Identity Provider: `POST /OS-FED-IDP/identity-providers`

Request:

    {
        “name” :  “acme_idp”,
        “description” :  “Stores ACME identities.”,
        “active” : true,
        “supported_protocols” : ['saml2'],
        "protocol_data" : "[<protocol specific data>]",
        "mapping_id": "0c2a74",
        “domain_id” : “12345”
    }


Response:

    Status: 201 Created

    {
        "identity-provider": {
            "name": "acme_idp",
            "active": true,
            “supported_protocols” : ['saml2'],
            "protocol_data" : "[<protocol specific data>]",
            "description": "Stores ACME identities",
            "mapping_id": "0c2a74",
            "id": "7fea2d",
            "links": {
                "self": "http://identity:35357/v3/OS-FED-IDP/identity-providers/7fea2d"
            }
        }
    }

### List identity providers: `GET /OS-FED-IDP/identity-providers`

Response:

    Status: 200 OK

    {
        "identity-providers": [
            {
                "id": "0c2a74",
                "name": "acme_idp",
                "active": true,
                “supported_protocols” : ['saml2'],
                "protocol_data" : "[<protocol specific data>]",
                "mapping_id": "7fea2d",
                "description": "Stores ACME identities",
                "links": {
                    "self": "http://identity:35357/v3/OS-FED-IDP/identity-providers/0c2a74"
                }
            },
            {
                "id": "7fea2d",
                "description": "Beta dev idp",
                "name": "beta_idp",
                “supported_protocols” : ['saml2'],
                "protocol_data" : "[<protocol specific data>]",
                "mapping_id": "0c2a74",
                "active": false,
                "links": {
                    "self": "http://identity:35357/v3/OS-FED-IDP/identity-providers/7fea2d"
                }
            }
        ],
        "links": {
            "next": null,
            "previous": null,
            "self": "http://identity:35357/v3/OS-FED-IDP/identity-providers"
        }
    }

### Get Identity provider: `GET /OS-FED-IDP/identity-providers/{identity_provider_id}`

Response:

    Status: 200 OK

    {
        "identity-provider": {
            "id": "7fea2d",
            "description": "Beta dev idp",
            "name": "beta_idp",
            “supported_protocols” : ['saml2'],
            "protocol_data" : "[<protocol specific data>]",
            "mapping_id": "0c2a74",
            "active": false,
            "links": {
                "self": "http://identity:35357/v3/OS-FED-IDP/identity-providers/7fea2d"
            }
        }
    }

### Delete identity provider: `DELETE /OS-FED-IDP/identity-providers/{identity_provider_id}`

When an identity provider is deleted, any tokens generated by that identity
provider will be revoked.

Response:

    Status: 204 No Content

### Update identity provider: `PATCH /OS-FED-IDP/identity-providers/{identity_provider_id}`

Only a identity provider's `description`, `name`, `active` and
`supported_protocols` are mutable. Attempting to PATCH an immutable attribute
should result in a HTTP 400 Bad Request.

Request:

    {
        "identity-provider": {
            "active": true
        }
    }

Response:

    Status: 200 OK

    {
        "identity-provider": {
            "description": "Beta dev idp",
            "name": "beta_idp",
            “supported_protocols” : ['saml2'],
            "protocol_data" : "[<protocol specific data>]",
            "mapping_id": "0c2a74",
            "active": true,
            "id": "7fea2d",
            "links": {
                "self": "http://identity:35357/v3/OS-OAUTH1/consumers/7fea2d",
                "mapping": "http://identity:35357/v3/OS-FED-IDP/identity-providers/7fea2d/assertion-mappings/0c2a74",
            }
        }
    }

When an identity provider is made inactive, any tokens generated by that identity
provider will be revoked.


### Add/Update public key for identity provider: `PUT /OS-FED-IDP/identity-providers/{identity_provider_id}/public-key`

Request:
    {
        "mQCNAi+UeBsAAAEEAMP0kXU75GQdzwwlMiwZBUKFUDRgR4wH9y5NP9JaZfVX8shT
        ESbCTbGSEExB2ktEPh5//dkfftsKNlzlAugKFKTgBv20tQ9lDKfdbPVR0HmTLz0e
        wVIeqEue4+Mt/Kq7kMcQy+5sX2RBAiZTYl0n/JdY/WxflU0taq1kH/UUPkklAAUR
        tB5NYXJ0eSBNY0ZseSA8bWFydHlAZnV0dXJlLmNvbT6JAJUCBRAvlHhGrWQf9RQ+
        SSUBAQX+BACnhx7OTb1SfAcJVF/1kuRPUWuGcl57eZgv4syc1O9T3YNr0terWQBT
        K0vFR00FdaBv9X9XwlxaBJHGeiBcmhaiOTwB912ysoteUzZHne3sHPw3MkYboAFx
        xHg43Cnj60OeZG2PKp/kU91ipOJP1cs8/xYOGkeoAMqDfwPeFlkBiA== =ddBN”
    }

Response:

    Status: 200 OK

### Get public key for an identity provider: `GET /OS-FED-IDP/identity-providers/{identity_provider_id}/public-key`

Response:

    Status: 200 OK

    {
        "mQCNAi+UeBsAAAEEAMP0kXU75GQdzwwlMiwZBUKFUDRgR4wH9y5NP9JaZfVX8shT
        ESbCTbGSEExB2ktEPh5//dkfftsKNlzlAugKFKTgBv20tQ9lDKfdbPVR0HmTLz0e
        wVIeqEue4+Mt/Kq7kMcQy+5sX2RBAiZTYl0n/JdY/WxflU0taq1kH/UUPkklAAUR
        tB5NYXJ0eSBNY0ZseSA8bWFydHlAZnV0dXJlLmNvbT6JAJUCBRAvlHhGrWQf9RQ+
        SSUBAQX+BACnhx7OTb1SfAcJVF/1kuRPUWuGcl57eZgv4syc1O9T3YNr0terWQBT
        K0vFR00FdaBv9X9XwlxaBJHGeiBcmhaiOTwB912ysoteUzZHne3sHPw3MkYboAFx
        xHg43Cnj60OeZG2PKp/kU91ipOJP1cs8/xYOGkeoAMqDfwPeFlkBiA== =ddBN”
    }


### Delete public key for identity provider: `DELETE /OS-FED-IDP/identity-providers/{identity_provider_id}/public-key

Response:

    Status: 204 No Content

